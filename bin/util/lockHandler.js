"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateLock = exports.updateLock = exports.lockData = void 0;
var parsers_1 = require("@yarnpkg/parsers");
var fs_1 = require("fs");
var lockHeader = "\n# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n# DevScript lockfile v1\n\n\n".replace(/^\n+/g, "");
exports.lockData = (0, fs_1.existsSync)("devscript.lock")
    ? (0, parsers_1.parseSyml)((0, fs_1.readFileSync)("devscript.lock", "utf8"))
    : {};
function updateLock() {
    if (!(0, parsers_1.stringifySyml)(exports.lockData) && !(0, fs_1.existsSync)("devscript.lock"))
        return;
    (0, fs_1.writeFileSync)("devscript.lock", lockHeader + (0, parsers_1.stringifySyml)(exports.lockData));
}
exports.updateLock = updateLock;
function validateLock(dependencies, devDependencies) {
    var updated = false;
    Object.keys(exports.lockData).forEach(function (dep) {
        if (!Object.keys(dependencies)
            .concat(Object.keys(devDependencies))
            .includes(dep)) {
            delete exports.lockData[dep];
            updated = true;
        }
    });
    if (updated)
        updateLock();
}
exports.validateLock = validateLock;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9ja0hhbmRsZXIuanMiLCJzb3VyY2VSb290IjoiLi8iLCJzb3VyY2VzIjpbInV0aWwvbG9ja0hhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNENBQTREO0FBQzVELHlCQUE2RDtBQUU3RCxJQUFNLFVBQVUsR0FBRyxtR0FLbEIsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBRVosUUFBQSxRQUFRLEdBS2YsSUFBQSxlQUFVLEVBQUMsZ0JBQWdCLENBQUM7SUFDL0IsQ0FBQyxDQUFDLElBQUEsbUJBQVMsRUFBQyxJQUFBLGlCQUFZLEVBQUMsZ0JBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbkQsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUVOLFNBQWdCLFVBQVU7SUFDekIsSUFBSSxDQUFDLElBQUEsdUJBQWEsRUFBQyxnQkFBUSxDQUFDLElBQUksQ0FBQyxJQUFBLGVBQVUsRUFBQyxnQkFBZ0IsQ0FBQztRQUFFLE9BQU87SUFDdEUsSUFBQSxrQkFBYSxFQUFDLGdCQUFnQixFQUFFLFVBQVUsR0FBRyxJQUFBLHVCQUFhLEVBQUMsZ0JBQVEsQ0FBQyxDQUFDLENBQUM7QUFDdkUsQ0FBQztBQUhELGdDQUdDO0FBRUQsU0FBZ0IsWUFBWSxDQUMzQixZQUVDLEVBQ0QsZUFFQztJQUVELElBQUksT0FBTyxHQUFHLEtBQUssQ0FBQztJQUNwQixNQUFNLENBQUMsSUFBSSxDQUFDLGdCQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxHQUFHO1FBQ2pDLElBQ0MsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQzthQUN4QixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQzthQUNwQyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQ2Q7WUFDRCxPQUFPLGdCQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDckIsT0FBTyxHQUFHLElBQUksQ0FBQztTQUNmO0lBQ0YsQ0FBQyxDQUFDLENBQUM7SUFDSCxJQUFJLE9BQU87UUFBRSxVQUFVLEVBQUUsQ0FBQztBQUMzQixDQUFDO0FBcEJELG9DQW9CQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlU3ltbCwgc3RyaW5naWZ5U3ltbCB9IGZyb20gXCJAeWFybnBrZy9wYXJzZXJzXCI7XHJcbmltcG9ydCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlU3luYywgd3JpdGVGaWxlU3luYyB9IGZyb20gXCJmc1wiO1xyXG5cclxuY29uc3QgbG9ja0hlYWRlciA9IGBcclxuIyBUSElTIElTIEFOIEFVVE9HRU5FUkFURUQgRklMRS4gRE8gTk9UIEVESVQgVEhJUyBGSUxFIERJUkVDVExZLlxyXG4jIERldlNjcmlwdCBsb2NrZmlsZSB2MVxyXG5cclxuXHJcbmAucmVwbGFjZSgvXlxcbisvZywgYGApO1xyXG5cclxuZXhwb3J0IGxldCBsb2NrRGF0YToge1xyXG5cdFtrZXk6IHN0cmluZ106IHtcclxuXHRcdHZlcnNpb246IHN0cmluZztcclxuXHRcdGlnbm9yZVVudGlsTmV4dDogXCJNQUpPUlwiIHwgXCJNSU5PUlwiIHwgXCJQQVRDSFwiO1xyXG5cdH07XHJcbn0gPSBleGlzdHNTeW5jKFwiZGV2c2NyaXB0LmxvY2tcIilcclxuXHQ/IHBhcnNlU3ltbChyZWFkRmlsZVN5bmMoXCJkZXZzY3JpcHQubG9ja1wiLCBcInV0ZjhcIikpXHJcblx0OiB7fTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVMb2NrKCkge1xyXG5cdGlmICghc3RyaW5naWZ5U3ltbChsb2NrRGF0YSkgJiYgIWV4aXN0c1N5bmMoXCJkZXZzY3JpcHQubG9ja1wiKSkgcmV0dXJuO1xyXG5cdHdyaXRlRmlsZVN5bmMoXCJkZXZzY3JpcHQubG9ja1wiLCBsb2NrSGVhZGVyICsgc3RyaW5naWZ5U3ltbChsb2NrRGF0YSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVMb2NrKFxyXG5cdGRlcGVuZGVuY2llczoge1xyXG5cdFx0W25hbWU6IHN0cmluZ106IHN0cmluZztcclxuXHR9LFxyXG5cdGRldkRlcGVuZGVuY2llczoge1xyXG5cdFx0W25hbWU6IHN0cmluZ106IHN0cmluZztcclxuXHR9XHJcbikge1xyXG5cdGxldCB1cGRhdGVkID0gZmFsc2U7XHJcblx0T2JqZWN0LmtleXMobG9ja0RhdGEpLmZvckVhY2goKGRlcCkgPT4ge1xyXG5cdFx0aWYgKFxyXG5cdFx0XHQhT2JqZWN0LmtleXMoZGVwZW5kZW5jaWVzKVxyXG5cdFx0XHRcdC5jb25jYXQoT2JqZWN0LmtleXMoZGV2RGVwZW5kZW5jaWVzKSlcclxuXHRcdFx0XHQuaW5jbHVkZXMoZGVwKVxyXG5cdFx0KSB7XHJcblx0XHRcdGRlbGV0ZSBsb2NrRGF0YVtkZXBdO1xyXG5cdFx0XHR1cGRhdGVkID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRpZiAodXBkYXRlZCkgdXBkYXRlTG9jaygpO1xyXG59XHJcbiJdfQ==