"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateLock = exports.updateLock = exports.lockData = void 0;
var parsers_1 = require("@yarnpkg/parsers");
var fs_1 = require("fs");
var lockHeader = "\n# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.\n# DevScript lockfile v1\n\n\n".replace(/^\n+/g, "");
exports.lockData = (0, fs_1.existsSync)("devscript.lock")
    ? (0, parsers_1.parseSyml)((0, fs_1.readFileSync)("devscript.lock", "utf8"))
    : {};
function updateLock() {
    if (!(0, parsers_1.stringifySyml)(exports.lockData) && !(0, fs_1.existsSync)("devscript.lock"))
        return;
    (0, fs_1.writeFileSync)("devscript.lock", lockHeader + (0, parsers_1.stringifySyml)(exports.lockData));
}
exports.updateLock = updateLock;
function validateLock(dependencies, devDependencies) {
    var updated = false;
    Object.keys(exports.lockData).forEach(function (dep) {
        if (!Object.keys(dependencies)
            .concat(Object.keys(devDependencies))
            .includes(dep)) {
            delete exports.lockData[dep];
            updated = true;
        }
    });
    if (updated)
        updateLock();
}
exports.validateLock = validateLock;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9ja0hhbmRsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbC9sb2NrSGFuZGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw0Q0FBNEQ7QUFDNUQseUJBQTZEO0FBRTdELElBQU0sVUFBVSxHQUFHLG1HQUtsQixDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFFWixRQUFBLFFBQVEsR0FLZixJQUFBLGVBQVUsRUFBQyxnQkFBZ0IsQ0FBQztJQUMvQixDQUFDLENBQUMsSUFBQSxtQkFBUyxFQUFDLElBQUEsaUJBQVksRUFBQyxnQkFBZ0IsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNuRCxDQUFDLENBQUMsRUFBRSxDQUFDO0FBRU4sU0FBZ0IsVUFBVTtJQUN6QixJQUFJLENBQUMsSUFBQSx1QkFBYSxFQUFDLGdCQUFRLENBQUMsSUFBSSxDQUFDLElBQUEsZUFBVSxFQUFDLGdCQUFnQixDQUFDO1FBQUUsT0FBTztJQUN0RSxJQUFBLGtCQUFhLEVBQUMsZ0JBQWdCLEVBQUUsVUFBVSxHQUFHLElBQUEsdUJBQWEsRUFBQyxnQkFBUSxDQUFDLENBQUMsQ0FBQztBQUN2RSxDQUFDO0FBSEQsZ0NBR0M7QUFFRCxTQUFnQixZQUFZLENBQzNCLFlBRUMsRUFDRCxlQUVDO0lBRUQsSUFBSSxPQUFPLEdBQUcsS0FBSyxDQUFDO0lBQ3BCLE1BQU0sQ0FBQyxJQUFJLENBQUMsZ0JBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLEdBQUc7UUFDakMsSUFDQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO2FBQ3hCLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO2FBQ3BDLFFBQVEsQ0FBQyxHQUFHLENBQUMsRUFDZDtZQUNELE9BQU8sZ0JBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNyQixPQUFPLEdBQUcsSUFBSSxDQUFDO1NBQ2Y7SUFDRixDQUFDLENBQUMsQ0FBQztJQUNILElBQUksT0FBTztRQUFFLFVBQVUsRUFBRSxDQUFDO0FBQzNCLENBQUM7QUFwQkQsb0NBb0JDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGFyc2VTeW1sLCBzdHJpbmdpZnlTeW1sIH0gZnJvbSBcIkB5YXJucGtnL3BhcnNlcnNcIjtcclxuaW1wb3J0IHsgZXhpc3RzU3luYywgcmVhZEZpbGVTeW5jLCB3cml0ZUZpbGVTeW5jIH0gZnJvbSBcImZzXCI7XHJcblxyXG5jb25zdCBsb2NrSGVhZGVyID0gYFxyXG4jIFRISVMgSVMgQU4gQVVUT0dFTkVSQVRFRCBGSUxFLiBETyBOT1QgRURJVCBUSElTIEZJTEUgRElSRUNUTFkuXHJcbiMgRGV2U2NyaXB0IGxvY2tmaWxlIHYxXHJcblxyXG5cclxuYC5yZXBsYWNlKC9eXFxuKy9nLCBgYCk7XHJcblxyXG5leHBvcnQgbGV0IGxvY2tEYXRhOiB7XHJcblx0W2tleTogc3RyaW5nXToge1xyXG5cdFx0dmVyc2lvbjogc3RyaW5nO1xyXG5cdFx0aWdub3JlVW50aWxOZXh0OiBcIk1BSk9SXCIgfCBcIk1JTk9SXCIgfCBcIlBBVENIXCI7XHJcblx0fTtcclxufSA9IGV4aXN0c1N5bmMoXCJkZXZzY3JpcHQubG9ja1wiKVxyXG5cdD8gcGFyc2VTeW1sKHJlYWRGaWxlU3luYyhcImRldnNjcmlwdC5sb2NrXCIsIFwidXRmOFwiKSlcclxuXHQ6IHt9O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUxvY2soKSB7XHJcblx0aWYgKCFzdHJpbmdpZnlTeW1sKGxvY2tEYXRhKSAmJiAhZXhpc3RzU3luYyhcImRldnNjcmlwdC5sb2NrXCIpKSByZXR1cm47XHJcblx0d3JpdGVGaWxlU3luYyhcImRldnNjcmlwdC5sb2NrXCIsIGxvY2tIZWFkZXIgKyBzdHJpbmdpZnlTeW1sKGxvY2tEYXRhKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUxvY2soXHJcblx0ZGVwZW5kZW5jaWVzOiB7XHJcblx0XHRbbmFtZTogc3RyaW5nXTogc3RyaW5nO1xyXG5cdH0sXHJcblx0ZGV2RGVwZW5kZW5jaWVzOiB7XHJcblx0XHRbbmFtZTogc3RyaW5nXTogc3RyaW5nO1xyXG5cdH1cclxuKSB7XHJcblx0bGV0IHVwZGF0ZWQgPSBmYWxzZTtcclxuXHRPYmplY3Qua2V5cyhsb2NrRGF0YSkuZm9yRWFjaCgoZGVwKSA9PiB7XHJcblx0XHRpZiAoXHJcblx0XHRcdCFPYmplY3Qua2V5cyhkZXBlbmRlbmNpZXMpXHJcblx0XHRcdFx0LmNvbmNhdChPYmplY3Qua2V5cyhkZXZEZXBlbmRlbmNpZXMpKVxyXG5cdFx0XHRcdC5pbmNsdWRlcyhkZXApXHJcblx0XHQpIHtcclxuXHRcdFx0ZGVsZXRlIGxvY2tEYXRhW2RlcF07XHJcblx0XHRcdHVwZGF0ZWQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGlmICh1cGRhdGVkKSB1cGRhdGVMb2NrKCk7XHJcbn1cclxuIl19